---
title: Meta Analyzing Family Based GWAS
subtitle: Everything Done So Far
---

# Cohorts And Phenotypes

| Cohohort | Phenotype | LDSC Test | Diag Plots and Tables | Notes |
| -------- |  | ------------------- | ----- | ------------ |
| STR | BMI | No (Couldn't compute) | Yes| |
| STR | EA | No  |  Yes  |  |
| STR | Height | Yes | Yes  |  |
| STR | CESD |  |  |  |
| STR | CPD | No (-ve)  |  Yes |  |
| STR | DPW | No  |  Yes  |  |
| STR | Extraversion | No (Too low power)  | Yes   |  |
| STR | HH Income |  No  (might be too low power)|  Yes  |  |
| STR | Income |  No (might be too low power) |  Yes  |  |
| STR | N Children |   No (too lower power) | Yes  |  |
| STR | SRH | No (Low power) | Yes   |  | 
| STR | IQ | Yes  |  Yes  |  |
| STR | SWB | Yes  | Yes   |  |
| Hunt | EA | Yes| Yes | |
| Hunt | BMI | Yes | Yes |  |
| Hunt | Height | Yes | Yes |  |
| Hunt | AAFB | Yes | Yes | |
| Hunt | Asthma | Yes | Yes | |
| Hunt | N Children |Yes | Yes | |
| Hunt | CPD | No (-ve) | Yes | |
| Hunt | Drinks Per Week | No (-ve) |Yes | |
| Hunt | Neuoroticism | Yes  |Yes | |
| Hunt | Age Menarche | Yes |Yes | |
| Hunt | BPD | Yes | Yes | |
| Hunt | FEV1 | No (-ve)|Yes | |
| Hunt | Non-HDL |Yes | Yes | |
| Hunt | HDL |Yes | Yes | |
| Hunt | Health |Yes | Yes | |
| Hunt | BPS | Yes | Yes ||
| Hunt | Smoke ever | No (-ve) | Yes ||
| Hunt | SWB | Yes | Yes ||
| Hunt | Deprcat | Yes | Yes ||
| Hunt | Deprcont | Yes | Yes ||
| Hunt | Eczema | Yes  | Yes ||
| Hunt | Rhinitis | No (cant compute)  |  Yes ||
| Generation Scotland | Glucose |  |  | Not analyzing  |
| Generation Scotland | Non-HDL| Yes  | Yes  |  |
| Generation Scotland | HDL |  Yes | Yes  |  |
| Generation Scotland | FEV1 | Yes  | Yes  |  |
| Generation Scotland | Height | Yes | Yes |  |
| Generation Scotland | BMI | Yes | Yes |  |
| Generation Scotland | CPD |  No (Not enough power) | Yes  |  |
| Generation Scotland | Cognitive ability | Yes  | Yes  |  |
| Generation Scotland | Vocabulary |  |  | Not analyzed |
| Generation Scotland | EA | Yes | Yes |  |
| Generation Scotland | BPS | Yes  | Yes  |  |
| Generation Scotland | BPD |  Yes | Yes  |  |
| Generation Scotland | Neuroticism | No (Couldn't compute)  | Yes  |  |
| Generation Scotland | EA Years | Yes | Yes  |  |
| Finnish Twins | EA| No (Negative h2 estimate) | Yes | |
| Finnish Twins | BMI | Yes  | Yes  | |
| Finnish Twins | Height | Yes  |  Yes | |
| Finnish Twins | AAFB | No (High se)  | Yes  | |
| Finnish Twins | ADHD | No (High se)  |  Yes | |
| Finnish Twins | CPD |  No (-ve) |  Yes | |
| Finnish Twins | Depression | Yes  | Yes  | |
| Finnish Twins | Eversmoke |  No (Couldnt compute) |  Yes | |
| Finnish Twins | HDL | No (Couldnt compute)  | Yes  | |
| Finnish Twins | Income | No (Couldn't Compute) | Yes  | |
| Finnish Twins | IQ | No (High se) |  Yes | |
| Finnish Twins | LDL | No (Couldn't compute) | Yes  | |
| Finnish Twins | N Children | No (high se) |  Yes | |
| Finnish Twins | Neuroticism | No (Couldn't compute) | Yes  | |
| Finnish Twins | BPS | Yes  | No | Direct SEF plot looks odd |
| Finnish Twins | TG | No (High se) | Yes  | I assume this is TGL |
| Finnish Twins | wellbeing |  No (Couldn't compute) | Yes | |
| Estonian Biobank | EA | Yes | Yes | Got batch controlled results |
| Estonian Biobank | BMI | Yes | Yes | Got batch controlled results |
| Estonian Biobank | MDD | Yes | |  | 
| Estonian Biobank | Ever Smoker | No (-ve 1) | | |
| Estonian Biobank | AAFB | Yes | | |
| Estonian Biobank | Asthma | Yes | | |
| Estonian Biobank | Depression | Yes | Yes | |
| Estonian Biobank | Eczema | Yes  | Yes | Got batch controlled results|
| Estonian Biobank | Hayfever | Yes | | |
| Estonian Biobank | Migraine | No (rg out of bounds) | Yes | Got batch controlled results|
| UKB | SWB | Yes | Yes  | |
| UKB | Glucose |  |  | Not analyzing  |
| UKB | Non-HDL | Yes  | Yes  | |
| UKB | HDL | Yes  | Yes  | |
| UKB | BPS | Yes | Yes  | |
| UKB | BPD |  Yes | Yes  | |
| UKB | SRH | No (-ve) | Yes  | |
| UKB | FEV1 | Yes  | Yes  | |
| UKB | Ever-smoked | No (-ve) | Yes  | |
| UKB | CPD | No (-ve)  | Yes  | |
| UKB | DPW | No (-ve) | Yes   | |
| UKB | Height | Yes | Yes | |
| UKB | BMI | Yes | Yes | |
| UKB | Cognitive ability  |  Yes | Yes  | |
| UKB | Neuroticism  |  Yes | Yes  | |
| UKB | AAFB  | Yes | Yes  | |
| UKB | N Children Male  |  |  | Not analyzed |
| UKB | N Children Female  |  |  |  Not analyzed|
| UKB | Household Income  |  Yes | Yes  | |
| UKB | Depression  | Yes  | Yes  | |
| UKB | EA | Yes | Yes | |
| UKB | Log hourly income  |  |  |  No data|
| UKB | N Children  | Yes  | Yes  | |
| MOBA | BMI | Yes | Yes | |
| MOBA | Height | Yes | Yes | |
| MOBA | Depressive symptoms | No  (h2 is negative) | | |
| MOBA | Income | No (h2 is negative) | | |
| MOBA | Fertility | No (Low power. h2 is negative sometimes in jack knife) | | |
| MOBA | EA | Yes| Yes| |
| Geisinger | BMI | Yes | Yes | |
| Geisinger | Height | Yes | Yes | |
| Geisinger | Depression | Yes | Yes | |
| Geisinger | EA | Yes | Yes | |
| Geisinger | Smoke-Ever | No ( -ve 1) | Yes | |
| Geisinger | Asthma | No (Couldnt compute) | Yes | |
| Geisinger | ADHD | Yes | Yes | |
| Geisinger | Eczema | No  | Yes | |
| Geisinger | BPD | Yes |  Yes | |
| Geisinger | BPS | Yes | Yes  | |
| Geisinger | Hayfever | Yes  | Yes | |
| Geisinger | HDL | Yes  | Yes | |
| Geisinger | Migraine | No (Couldnt compute)  | Yes | |
| Geisinger | Non-HDL | Yes  | Yes | |
| Geisinger | FEV1 | Yes  | Yes | |
| Lifeline | BMI/BMI18 | Yes  | Yes  | |
| Lifeline | Height/Height18 | Yes | Yes | |
| Lifeline | EA | Yes | Yes  | |
| Lifeline | HDL | Yes| Yes | |
| LIfeline | LDL | Yes  |  Yes | |
| Lifeline | TGL | Yes  | Yes  | |
| Lifeline | Cholestrol | Yes | Yes  | | 
| Lifeline | Smoking | No (-ve) | Yes | |
| Lifeline | Cognition (unique) | Yes | Yes | |
| Minnesotta twins | EA | Yes | Yes | |
| Minnesotta twins | BMI | Yes | Yes | |
| Minnesotta twins | Height | Yes | Yes | | 
| Minnesotta twins | BPS | No (not enough power) | Yes | rg is weird. Very few valid alleles |
| Minnesotta twins | CPD | No (high se) | | |
| Minnesotta twins | DPW | No | | |
| Minnesotta twins | ES | No | | |
| Minnesotta twins | Income | No | | |
| Minnesotta twins | IQ | No | | |
| Minnesotta twins | Stress | Yes | | Equivalent to neuroticism. |
| Minnesotta twins | SWB | Yes | | |
| Dutch Twins | Asthma | Yes | Yes | |
| Dutch Twins | BMI | Yes | Yes | |
| Dutch Twins | Cannabis |  No (Couldn't compute) | Yes  | |
| Dutch Twins | CPD | No (-ve h2)  | Yes | |
| Dutch Twins | BPD | No (not enough power) | Yes  | |
| Dutch Twins | Depression | Yes | Yes  | |
| Dutch Twins | EA |Yes |Yes  | |
| Dutch Twins | DPW | No (-ve) | Yes  | |
| Dutch Twins | EverSmoke | No (couldn't compute) | Yes | |
| Dutch Twins | Extraversion | Yes | Yes  | |
| Dutch Twins | HDL | Yes |  Yes | |
| Dutch Twins | Height |Yes  | Yes  | |
| Dutch Twins | Menarche | Yes | Yes  | |
| Dutch Twins | Migraine | No (Couldn't compute) | Yes  | |
| Dutch Twins | Morning Person | No (Couldn't compute) | Yes  | |
| Dutch Twins | Neuroticism | Yes | Yes  | |
| Dutch Twins | N children | No (Couldn't compute) | Yes  | |
| Dutch Twins | NonHDL | Yes |  Yes | |
| Dutch Twins | Satisfaction With life | No (Couldn't Compute) | Yes | Ref file is SWB |
| Dutch Twins | BPS  | No (Couldn't compute) | Yes  | |
| Dutch Twins | Self Rated Health  | No (-ve) | Yes  | |
| QIMR | EA  | Yes (borderline) | Yes  |  |


Notes:

1. LDL is taken as the reference for non-HDL cholestrol
2. QIMR's info-R2 cutoff should be 0.95 instead of 0.99

# Methodology

## Quality control

Each cohort goes through some quality control checks. 

- First we look at the genetic correlation of the population effects with a reference sample where possible (in cases where the summary statistics aren't well powered LDSC might fail to give an estimate). We expect this genetic correlation to be around 1.
- We look at the QQ-plots of every effect from each cohort
- We plot standard errors of each effect from the summary statistics against $\sqrt{(f)(1-f)}$. We expect this to show a downward sloping curve.

The cohort level data also goes through a couple of filters:

- We apply an MAF filter of 0.01
- We exclude SNPs with Hardy-Weinberg equilibrium exact test $P$ values lower than $10^{-6}$
- We exclude SNPs which have an imputation $R^2$ less than 0.99 and an average call rate less than 0.99. 
- We compute the sampling correlations between all combinations of effects (direct-paternal, direct-maternal, paternal-maternal, etc.) and drop SNPs which have values outside of 6 standard deviations from the mean. This metric is useful since it captures SNPs which have imputation issues either with the proband or parental genotypes.
- We use Haplotype Reference Consortium reference panel to check for strand misalignment, position mismatch, allele concordance, and allele frequency discrepancies.

## Meta analysis

We want to estimate the parameters of the model:

$$
Y_i = \delta g_i + \eta_p g_{p(i)} + \eta_m g_{m(i)} + \epsilon_i
$$

Where $\epsilon$ is uncorrelated with $g_i, g_{p(i)}, g_{m(i)}$. We want to estimate $\theta := \begin{bmatrix} \delta & \eta_p & \eta_m \end{bmatrix}^T$ using different samples and different observations of sibling and parental alleles. Let sample 1 be a sample where only proband genotypes are available and to which standard GWAS analysis has been applied. Let sample 2 be a sample of sibling pairs with observed genotype and phenotype, to which the sib-difference method has been applied. Let sample 3 be a sample where only proband and paternal genotype has been observed, and the estimate comes from regression of proband phenotype jointly onto proband and paternal genotype. Let sample 4 be a sample where only proband and maternal genotype has been observed, and the estimate comes from regression of proband phenotype jointly onto proband and maternal genotype. And let sample 5 be a sample where proband and both parents genotypes have been observed, and the estimate comes from regression of proband phenotype jointly onto proband, maternal, and paternal genotypes. Then we can combine the estimates from these regressions using the following matrices that give the linear transformation between $\theta$ and the expected estimates from the regressions in each subsample:

| Sample | Observed Genotype | Regression | $\mathbb{E}(z_i)$ | $A_i$ |
| ------ | ---------------- | ----------- | ---------------- | -------- |
| 1 | Proband | $Y_{ij} \sim g_i$ | $\delta + \frac{\eta_m + \eta_p}{2}$| $\begin{bmatrix} 1 & 0.5 & 0.5 \end{bmatrix}$| 
| 2 | Sibling Pair | $(Y_{i1} - Y_{i2}) \sim (g_{i1} - g_{i2})$ | $\delta$| $\begin{bmatrix} 1 & 0 & 0 \end{bmatrix}$| 
| 3 | Proband and Paternal | $Y_{i} \sim g_i + g_{p(i)}$ | $\begin{bmatrix} \delta + \frac{2}{3} \eta_m \\ \eta_p - \frac{1}{3} \eta_m \end{bmatrix}$| $\begin{bmatrix} 1 & 0 & \frac{2}{3} \\ 0 & 1 & -\frac{1}{3} \end{bmatrix}$| 
| 4 | Proband and Maternal | $Y_{i} \sim g_i + g_{m(i)}$ | $\begin{bmatrix} \delta + \frac{2}{3} \eta_p \\ \eta_m - \frac{1}{3} \eta_p \end{bmatrix}$| $\begin{bmatrix} 1 &  \frac{2}{3} & 0 \\ 0 & -\frac{1}{3} & 1 \end{bmatrix}$| 
| 5 | Proband, Maternal, Paternal | $Y_i \sim g_i + g_{p(i)} + g_{m(i)}$ | $\begin{bmatrix} \delta \\ \eta_p \\ \eta_m \end{bmatrix}$| $I_3$| 

We want to estimate the parameter vector $\theta$ and we observe $z_i \sim \mathbb{N}(A_i \theta, \Sigma_i)$ for $i \in {1, ..., k}$ where $i$ indexes the cohort. $A_i$ is a matrix which when applied to $\alpha$ linearly transforms it into the resulting parameters for which we have the sample analogs. The MLE for $\theta$ is:

$$
\hat{\theta} = \left(\sum_{i=1}^k A_i^T \Sigma^{-1} A_i \right) \left( \sum_{i=1}^{k} A_i^T \Sigma^{-1} z_i \right)
$$

and

$$
\text{Var}(\hat{\theta}) = \left(\sum_{i=1}^k A_i^T \Sigma_i^{-1} A_i \right)^{-1}
$$

