Computing / analyzing PGIs with MCS validation for Junming's FGWAS paper.

Pipeline:

1. prepare_phenotypes_fgwas.R: Prepare MCS validation phenotypes. Three phenotypes are being used: BMI, EA, and height. Read in the raw phenotype files from the server, merge on IIDs, then filter to get the relevant sample only. Two samples: EUR and SAS. EUR sample is MCS individuals of EUR ancestry, with MZ twins removed (/disk/genetics/data/mcs/private/latest/raw/genotyped/NCDS_SFTP_1TB_1/imputed/filter_extract/eur_samples_mz_removed.txt). SAS sample is MCS individuals of SAS ancestry, with MZ twins removed (/disk/genetics/data/mcs/private/latest/raw/genotyped/NCDS_SFTP_1TB_1/imputed/filter_extract/sas_samples_mz_removed.txt). Sample files were prepared by Junming. After filtering to get the relevant sample, merge with covariates file for that ancestry. Remove outliers (top and bottom 0.5% of sample) from each phenotype, as well as negative values from height and BMI. Standardize height and BMI by sex such that for each phenotype, each sex has mean 0 and variance 1.

2. run_pgi.sh: Calls prscsfunc_fgwas.sh to run PRSCS on sumstats prepared by Junming to get PGI weights. Get direct effect PGI weights for all 4 methods (unified, robust, sibdiff, Young), and population effect PGI weights for unified only. Uses UKB EUR LD reference panel from PRSCS.

3. run_fpgs.sh: Calls fpgipipeline_function_fgwas.sh, which takes PGI weights from PRSCS and creates fPGIs for the MCS EUR validation sample. Generates a phenotype file for the phenotype of interest, which has NAs removed and variance scaled to 1. Then, runs SNIPar pgy.py to get proband, paternal, and maternal PGIs (though we're only interested in proband in the end), with the --scale_pgs flag so that PGIs are scaled appropriately. Then runs fPGI regression using pgs.py, with no covariates, and --scale_phen to scale the outcome phenotype. We run both the 1-generation (proband only) and 2-generation (proband and parental PGIs) models, but ultimately are only interested in the beta from the 1-generation model.

4. compile_results_fgwas.py: Compiles betas (coefficient on proband PGI), associated SE, and R2 from the phenotype ~ proband PGI regression. R2 is calculated as beta^2 - (beta SE)^2.